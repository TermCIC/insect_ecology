<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EIL & ET Calculator for IPM</title>

<style>
    body {
        font-family: system-ui, sans-serif;
        background: #f5f5f5;
        padding: 20px;
        max-width: 700px;
        margin: auto;
        line-height: 1.5;
    }
    h1 { text-align: center; }
    label {
        font-weight: bold;
        margin-top: 12px;
        display: block;
    }
    input {
        width: 100%;
        padding: 8px;
        font-size: 16px;
        margin-top: 6px;
    }
    button {
        width: 100%;
        padding: 12px;
        margin-top: 20px;
        background: #333;
        color: #fff;
        border: none;
        font-size: 18px;
        border-radius: 4px;
    }
    #result, #meaning, #etresult, #etmeaning, #exampleBox {
        margin-top: 20px;
        padding: 15px;
        background: white;
        border-radius: 4px;
        font-size: 17px;
        box-shadow: 0 0 4px rgba(0,0,0,0.15);
    }
    .section-title {
        font-weight: bold;
        margin-top: 30px;
        font-size: 20px;
    }
</style>
</head>

<body>

<h1>EIL & ET Calculator (IPM)</h1>

<p>The Economic Injury Level (EIL) is the pest density at which the cost of damage equals the cost of control. 
Below this level, control is not economically justified. Above this level, action is required.</p>

<div class="section-title">Input Parameters for EIL</div>

<label>Cost of control (C) — THB per unit area</label>
<input type="number" id="C" placeholder="e.g., 600">

<label>Market value of crop (V) — THB per kg</label>
<input type="number" id="V" placeholder="e.g., 7">

<label>Damage per unit injury (D) — proportion yield loss per injury</label>
<input type="number" id="D" placeholder="e.g., 0.02" step="0.0001">

<label>Injury per pest (I) — injury caused by 1 insect (optional)</label>
<input type="number" id="I" placeholder="leave blank if unknown" step="0.0001">

<label>Control effectiveness (K) — proportion (0 to 1)</label>
<input type="number" id="K" placeholder="e.g., 0.8" step="0.01">

<button onclick="calcEIL()">Calculate EIL</button>

<div id="result">Enter values to calculate EIL.</div>
<div id="meaning"></div>

<div class="section-title">Economic Threshold (ET)</div>

<p>The Economic Threshold (ET) is the pest density at which action must be taken 
<b>before</b> the population reaches the EIL.  
ET is always lower than EIL because pests grow and cause damage during the time required to take action.</p>

<label>ET proportion relative to EIL (default 0.7 = 70 percent)</label>
<input type="number" id="ETp" value="0.7" step="0.01">

<button onclick="calcET()">Calculate ET</button>

<div id="etresult">Enter ET proportion after calculating EIL.</div>
<div id="etmeaning"></div>

<div class="section-title">Formula Explanation</div>

<p>EIL formula (simplified):<br>
<b>EIL = C / (V × D × K)</b></p>

<p>EIL formula (full Pedigo model):<br>
<b>EIL = C / (V × D × I × K)</b></p>

<p>D × I together represent the total impact per pest.</p>

<!-- REAL CASE EXAMPLE BOX -->
<div class="section-title">Real Case Example</div>

<details>
<summary style="font-size:18px; font-weight:bold; cursor:pointer;">Click to open example (Fall armyworm in maize)</summary>

<div id="exampleBox">

<h3>Example: Spodoptera frugiperda (FAW) in maize</h3>

<p><b>Scenario:</b><br>
A maize farmer wants to know when FAW larvae are causing enough damage to justify insecticide spraying.</p>

<h4>Given values:</h4>
<ul>
<li>Cost of control C = <b>600 THB per rai</b></li>
<li>Market value V = <b>7 THB per kg</b></li>
<li>Damage per injury D = <b>0.02</b> (2 percent yield loss per unit injury)</li>
<li>Injury per pest I = <b>(unknown)</b> — leave blank</li>
<li>Control effectiveness K = <b>0.8</b> (80 percent kill)</li>
<li>ET proportion = <b>0.7</b> (act at 70 percent of EIL)</li>
</ul>

<h4>Step 1: Calculate EIL</h4>

<p>Simplified formula (I not used):<br>
<b>EIL = C / (V × D × K)</b></p>

<p>Plug in the values:<br>
EIL = 600 / (7 × 0.02 × 0.8)</p>

<p>7 × 0.02 = 0.14<br>
0.14 × 0.8 = 0.112</p>

<p>EIL = 600 / 0.112 = <b>5357 larvae per rai</b></p>

<p>If there are 5000 maize plants per rai:<br>
EIL per plant ≈ <b>1.07 larvae per plant</b></p>

<h4>Meaning:</h4>
<p>Economic injury begins when each maize plant has <b>about one FAW larva</b>.  
Above this density, the value of lost yield is greater than the cost of spraying.</p>

<h4>Step 2: Calculate ET</h4>

<p>ET = EIL × 0.7</p>

<p>ET = 1.07 × 0.7 = <b>0.75 larvae per plant</b></p>

<h4>Meaning of ET:</h4>

<p>Control must begin when there are <b>0.7 to 0.8 larvae per plant</b>.  
If the farmer waits until 1 larva per plant (the EIL), the population may already be causing economic loss.</p>

<h3>Final interpretation for students:</h3>

<p><b>EIL tells you when damage equals control cost.</b><br>
<b>ET tells you when to act so you never reach the EIL.</b></p>

<p>In this example:<br>
ET ≈ <b>0.75 larvae per plant</b>  
EIL ≈ <b>1.07 larvae per plant</b></p>

<p>So action should be taken earlier, not at the last moment.</p>

</div>
</details>

</body>

<script>
let lastEIL = null;

function calcEIL() {
    const C = parseFloat(document.getElementById("C").value);
    const V = parseFloat(document.getElementById("V").value);
    const D = parseFloat(document.getElementById("D").value);
    const I = document.getElementById("I").value;
    const K = parseFloat(document.getElementById("K").value);

    const result = document.getElementById("result");
    const meaning = document.getElementById("meaning");

    if (isNaN(C) || isNaN(V) || isNaN(D) || isNaN(K)) {
        result.innerHTML = "Please fill C, V, D, and K.";
        meaning.innerHTML = "";
        return;
    }

    let EIL;
    let formulaUsed = "";
    let biologicalMeaning = "";

    if (I.trim() === "") {
        EIL = C / (V * D * K);
        formulaUsed = "EIL = C / (V × D × K)";
        biologicalMeaning =
            "This EIL value represents the pest density where yield loss equals the cost of control.";
    } else {
        const Ival = parseFloat(I);
        if (isNaN(Ival)) {
            result.innerHTML = "Invalid I value.";
            meaning.innerHTML = "";
            return;
        }
        EIL = C / (V * D * Ival * K);
        formulaUsed = "EIL = C / (V × D × I × K)";
        biologicalMeaning =
            "This EIL value shows the density at which injury per insect multiplied by damage effect equals the cost of control.";
    }

    lastEIL = EIL;

    result.innerHTML =
        `<b>Calculated EIL: ${EIL.toFixed(4)}</b><br><br>
         Formula used: ${formulaUsed}`;

    meaning.innerHTML =
        `<b>Meaning of this EIL value:</b><br>${biologicalMeaning}<br><br>
         If pest density rises above <b>${EIL.toFixed(4)}</b>, economic loss will exceed the cost of control.`;
}

function calcET() {
    const etDiv = document.getElementById("etresult");
    const etMeaning = document.getElementById("etmeaning");
    const ETp = parseFloat(document.getElementById("ETp").value);

    if (lastEIL === null) {
        etDiv.innerHTML = "Please calculate EIL first.";
        etMeaning.innerHTML = "";
        return;
    }

    if (isNaN(ETp) || ETp <= 0 || ETp >= 1) {
        etDiv.innerHTML = "ET proportion must be between 0 and 1 (e.g., 0.7).";
        etMeaning.innerHTML = "";
        return;
    }

    const ET = lastEIL * ETp;

    etDiv.innerHTML =
        `<b>Calculated ET: ${ET.toFixed(4)}</b><br><br>
         ET proportion used: ${ETp}`;

    etMeaning.innerHTML =
        `<b>Meaning of ET:</b><br>
         ET indicates the pest density at which management must begin <b>before</b> reaching the EIL.  
         This ET of <b>${ET.toFixed(4)}</b> means the farmer should act at this point so pests do not reach the EIL and cause economic damage.`;
}
</script>

</html>